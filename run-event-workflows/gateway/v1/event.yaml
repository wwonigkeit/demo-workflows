direktiv_api: endpoint/v1
allow_anonymous: true
path: /v1/event
plugins:
  target:
    type: "target-event"
    configuration:
      namespace: "demo-workflows"
  inbound:
    # - type: "event-filter"
    #   configuration:
    #     script: |-
    #         // Make modifications to AWS events to fitler only needed events
    #         if ((input["source"] == "aws.ec2") && (input["type"] == "AWS API Call via CloudTrail")) {
                
    #             // This is an AWS CloudTrail event
    #             input["type"] = "aws.api.cloudtrail" // rename the AWS event to something more readable

    #             // So we didn't find the TerminateInstances event, but we want to see all the other events 
    #             input["eventName"] = input["data"].detail.eventName
    #             return input
    #         } else {
            
    #             // Drop the event - no matches
    #             return null

    #         }
    #     allow_non_events: false
    - type: "acl"
      configuration:
        allow_groups:
          - "aws-events"
        allow_tags:
          - "aws-events-ap-southeast-2"
  auth:
    - type: "key-auth"
      configuration:
        add_username_header: false
        add_tags_header: false
        add_groups_header: false
        key_name: "Aws-Authentication-Header"
methods:
  - POST
timeout: 5